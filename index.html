<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Minha Coleção de Filmes</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<style>
:root {
    --primary-color:#2c3e50;--secondary-color:#3498db;--accent-color:#e74c3c;
    --light-color:#ecf0f1;--dark-color:#34495e;--success-color:#2ecc71;
    --warning-color:#f39c12;--background-dark:#1a2530;--card-bg:#2c3e50;
    --dvd-color:#9b59b6;--digital-color:#3498db;--vhs-color:#e67e22;
    --telegram-color:#1da1f2;--watched-color:#2ecc71;
}
*{margin:0;padding:0;box-sizing:border-box;font-family:'Segoe UI',Tahoma,Geneva,Verdana,sans-serif;}
body{background:linear-gradient(135deg,var(--background-dark),var(--primary-color));color:white;min-height:100vh;padding:15px;}
.container{max-width:1200px;margin:0 auto;}
header{text-align:center;margin-bottom:20px;}
.app-title{font-size:2rem;font-weight:800;margin-bottom:5px;}
.app-title span{color:var(--accent-color);}
.app-subtitle{color:#bbb;margin-bottom:20px;}
.tabs{display:flex;flex-wrap:wrap;margin-bottom:15px;gap:8px;overflow-x:auto;}
.tab{padding:10px 15px;background:rgba(255,255,255,0.1);border-radius:8px;cursor:pointer;transition:all 0.3s;font-weight:500;white-space:nowrap;}
.tab:hover{background:rgba(255,255,255,0.2);}
.tab.active{background:var(--secondary-color);font-weight:600;}
.tab.dvd{border-left:4px solid var(--dvd-color);}
.tab.digital{border-left:4px solid var(--digital-color);}
.tab.vhs{border-left:4px solid var(--vhs-color);}
.tab.telegram{border-left:4px solid var(--telegram-color);}
.tab.watched{border-left:4px solid var(--watched-color);}
.tab.favorite{border-left:4px solid var(--accent-color);}
.movie-form{background:rgba(255,255,255,0.1);padding:15px;border-radius:10px;margin-bottom:20px;}
.form-row{display:flex;flex-wrap:wrap;gap:10px;margin-bottom:10px;}
.form-group{flex:1;min-width:150px;}
.form-group label{display:block;margin-bottom:5px;font-weight:500;}
.form-control{width:100%;padding:8px;border:none;border-radius:6px;background:rgba(255,255,255,0.9);}
.btn{padding:10px 15px;border:none;border-radius:6px;cursor:pointer;font-weight:600;transition:all 0.3s;}
.btn-primary{background:var(--secondary-color);color:white;}
.btn-success{background:var(--success-color);color:white;}
.btn-danger{background:var(--accent-color);color:white;}
.btn:hover{opacity:0.9;transform:translateY(-2px);}
.movies-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(250px,1fr));gap:15px;}
.movie-card{background:var(--card-bg);border-radius:10px;overflow:hidden;box-shadow:0 5px 15px rgba(0,0,0,0.2);transition:transform 0.3s;}
.movie-card:hover{transform:translateY(-5px);}
.movie-poster{width:100%;height:300px;object-fit:cover;}
.movie-info{padding:10px;}
.movie-title{font-size:1rem;font-weight:700;margin-bottom:3px;}
.movie-year{color:#bbb;margin-bottom:5px;}
.movie-details{margin-bottom:5px;font-size:0.85rem;color:#ddd;}
.movie-type{display:inline-block;padding:3px 6px;border-radius:4px;font-size:0.75rem;font-weight:600;margin-top:3px;}
.type-dvd{background:var(--dvd-color);}
.type-digital{background:var(--digital-color);}
.type-vhs{background:var(--vhs-color);}
.type-telegram{background:var(--telegram-color);}
.movie-actions{display:flex;justify-content:space-between;margin-top:10px;}
.action-btn{padding:5px 8px;border:none;border-radius:4px;cursor:pointer;font-size:0.8rem;}
.delete-btn{background:var(--accent-color);color:white;}
.watched-btn{background:var(--watched-color);color:white;}
.favorite-btn{background:var(--secondary-color);color:white;}
.fade-in{animation:fadeIn 0.5s ease-out;}
@keyframes fadeIn{from{opacity:0;transform:translateY(20px);}to{opacity:1;transform:translateY(0);}}
.empty-state{text-align:center;padding:30px;color:#bbb;grid-column:1/-1;}
.empty-state i{font-size:2.5rem;margin-bottom:10px;color:#555;}
@media(max-width:768px){.form-row{flex-direction:column;}.movies-grid{grid-template-columns:1fr;}}
</style>
</head>
<body>
<div class="container">
<header>
<h1 class="app-title">Minha <span>Coleção</span> de Filmes</h1>
<p class="app-subtitle">Organize seus filmes de forma simples</p>
</header>

<!-- Abas -->
<div class="tabs">
<div class="tab all active" data-filter="all">Todos</div>
<div class="tab dvd" data-filter="DVD">DVD</div>
<div class="tab digital" data-filter="Digital">Digital</div>
<div class="tab vhs" data-filter="VHS">VHS</div>
<div class="tab telegram" data-filter="Telegram">Telegram</div>
<div class="tab watched" data-filter="watched">Assistidos</div>
<div class="tab favorite" data-filter="favorite">Favoritos</div>
</div>

<!-- Formulário -->
<div class="movie-form">
<h3>Adicionar/Editar Filme</h3>
<form id="movie-form">
<div class="form-row">
<div class="form-group">
<label for="movie-title">Título</label>
<input type="text" id="movie-title" class="form-control" placeholder="Digite o título">
</div>
<div class="form-group">
<label for="movie-year">Ano</label>
<input type="number" id="movie-year" class="form-control" placeholder="Ano">
</div>
</div>
<div class="form-row">
<div class="form-group">
<label for="movie-genre">Gênero</label>
<input type="text" id="movie-genre" class="form-control" placeholder="Ex: Ação, Drama">
</div>
<div class="form-group">
<label for="movie-director">Diretor</label>
<input type="text" id="movie-director" class="form-control" placeholder="Nome do diretor">
</div>
</div>
<div class="form-row">
<div class="form-group">
<label for="movie-type">Tipo de Mídia</label>
<select id="movie-type" class="form-control">
<option value="DVD">DVD</option>
<option value="Digital">Digital</option>
<option value="VHS">VHS</option>
<option value="Telegram">Telegram</option>
</select>
</div>
<div class="form-group">
<label for="movie-rating">Nota Pessoal</label>
<input type="number" id="movie-rating" class="form-control" min="1" max="10" placeholder="1 a 10">
</div>
</div>
<div class="form-row">
<div class="form-group">
<label for="movie-tags">Tags (separadas por vírgula)</label>
<input type="text" id="movie-tags" class="form-control" placeholder="Ex: clássico, favorito">
</div>
<div class="form-group">
<label>
<input type="checkbox" id="movie-watched"> Já assisti
</label>
</div>
</div>
<button type="submit" class="btn btn-primary">Adicionar / Atualizar</button>
</form>
</div>

<!-- Grid -->
<div class="movies-grid" id="movies-container"></div>
</div>

<script type="module">
// ----------------- Firebase -----------------
import { initializeApp } from "https://www.gstatic.com/firebasejs/11.0.2/firebase-app.js";
import { getAuth, onAuthStateChanged, GoogleAuthProvider, signInWithPopup, signOut } from "https://www.gstatic.com/firebasejs/11.0.2/firebase-auth.js";
import { getFirestore, enableIndexedDbPersistence, doc, setDoc, getDocs, collection } from "https://www.gstatic.com/firebasejs/11.0.2/firebase-firestore.js";

const firebaseConfig = { /* SUA CONFIGURAÇÃO AQUI */ };
const app = initializeApp(firebaseConfig);
const auth = getAuth(app);
const db = getFirestore(app);
enableIndexedDbPersistence(db).catch(err => console.warn(err));

// ----------------- Estado -----------------
let movies = [];
let currentFilter = "all";

// ----------------- DOM -----------------
const movieForm = document.getElementById("movie-form");
const moviesContainer = document.getElementById("movies-container");
const tabs = document.querySelectorAll(".tab");

// ----------------- Eventos -----------------
tabs.forEach(tab => {
tab.addEventListener("click", () => {
tabs.forEach(t=>t.classList.remove("active"));
tab.classList.add("active");
currentFilter = tab.dataset.filter;
renderMovies();
});

});

movieForm.addEventListener("submit", async e=>{
e.preventDefault();
const title=document.getElementById("movie-title").value.trim();
const year=document.getElementById("movie-year").value.trim();
if(!title){alert("Digite ao menos o título!");return;}
const genre=document.getElementById("movie-genre").value.trim();
const director=document.getElementById("movie-director").value.trim();
const type=document.getElementById("movie-type").value;
const rating=document.getElementById("movie-rating").value;
const tags=document.getElementById("movie-tags").value.split(",").map(t=>t.trim()).filter(t=>t);
const watched=document.getElementById("movie-watched").checked;

const movieId=Date.now();
const uid=auth.currentUser.uid;
const movieData={Title:title,Year:year||null,Genre:genre||null,Director:director||null,MediaType:type,Rating:rating||null,Tags:tags,Watched:watched};

await setDoc(doc(db, `users/${uid}/movies/${movieId}`), movieData);
alert(`${title} adicionado à sua coleção!`);
loadMovies();
movieForm.reset();
});

// ----------------- Render -----------------
async function loadMovies(){
const uid=auth.currentUser.uid;
const querySnapshot=await getDocs(collection(db, `users/${uid}/movies`));
movies=[];
querySnapshot.forEach(doc=>movies.push({...doc.data(),id:doc.id}));
renderMovies();
}

function renderMovies(){
moviesContainer.innerHTML="";
let filtered=movies;
if(currentFilter!=="all"){
if(currentFilter==="watched") filtered=movies.filter(m=>m.Watched);
else if(currentFilter==="favorite") filtered=movies.filter(m=>m.Favorite);
else filtered=movies.filter(m=>m.MediaType===currentFilter);
}
if(filtered.length===0){
moviesContainer.innerHTML=`<div class="empty-state"><i class="fas fa-film"></i><h3>Nenhum filme</h3></div>`;
return;
}
filtered.forEach(m=>{
const card=document.createElement("div");
card.className="movie-card fade-in";
card.innerHTML=`
<img src="${m.Poster||'https://via.placeholder.com/300x450/2c3e50/ecf0f1?text=Sem+Imagem'}" class="movie-poster" alt="${m.Title}">
<div class="movie-info">
<h3 class="movie-title">${m.Title}</h3>
<p class="movie-year">${m.Year||''}</p>
<p class="movie-details">${m.Genre||''}</p>
<p class="movie-details">${m.Director||''}</p>
<span class="movie-type type-${m.MediaType.toLowerCase()}">${m.MediaType}</span>
${m.Watched?'<span style="color:#2ecc99;margin-left:5px;"><i class="fas fa-check-circle"></i> Assistido</span>':''}
<div class="movie-actions">
<button class="action-btn watched-btn" onclick="toggleWatched('${m.id}')">${m.Watched?'<i class="fas fa-undo"></i> Não assistido':'<i class="fas fa-check"></i> Assistido'}</button>
<button class="action-btn delete-btn" onclick="deleteMovie('${m.id}')"><i class="fas fa-trash"></i> Remover</button>
</div>
</div>`;
moviesContainer.appendChild(card);
});

// ----------------- Funções -----------------
window.toggleWatched=async function(id){
const uid=auth.currentUser.uid;
const movieRef=doc(db, `users/${uid}/movies/${id}`);
const movie=movies.find(m=>m.id===id);
await setDoc(movieRef,{...movie,Watched:!movie.Watched});
loadMovies();
};

window.deleteMovie=async function(id){
if(confirm("Remover este filme?")){
const uid=auth.currentUser.uid;
await setDoc(doc(db, `users/${uid}/movies/${id}`),{});
loadMovies();
};
}
</script>
</body>
</html>